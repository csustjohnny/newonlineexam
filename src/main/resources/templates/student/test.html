<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>考试</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/lib/layui-v2.5.6/css/layui.css" media="all">
    <link rel="stylesheet" href="/css/public.css" media="all">
    <link rel="stylesheet" href="/lib/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/question.css">
    <style>
        .panel-title {
            font-size: 16px;
            font-weight: 500;
            line-height: 30px;
            padding: 5px 15px;
        }
        .codeTitle {
            font-size: 20px;
            font-weight: 400;
            margin: 25px 0 8px;
            color: #3091f2;
        }
        .sample-input .sample-output {
            width: 50%;
            -ms-flex: 1 1 auto;
            flex: 1 1 auto;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-direction: column;
            flex-direction: column;
            margin-right: 5%;
        }
    </style>
</head>
<body>
<div style="padding: 20px; background-color: #F2F2F2;">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md9">
            <div class="layui-card">
                <div style="background: #009E94" class="layui-card-header exam-title" id="exam_title"></div>
                <div class="layui-card-body">
                    <div class="layui-card">
                        <div class="layui-card-header ">
                            <div class="question_title">选择题</div>
                        </div>
                        <div class="layui-card-body">
                            <ul id="choiceQuestionList">
                                <!--选择题列表-->
                            </ul>
                        </div>
                    </div>
                    <div class="layui-card">
                        <div class="layui-card-header">
                            <div class="question_title">判断题</div>
                        </div>
                        <div class="layui-card-body">
                            <ul id="judgementQuestionList">
                                <!--判断题列表-->
                            </ul>
                        </div>
                    </div>
                    <div class="layui-card">
                        <div class="layui-card-header">
                            <div class="question_title">填空题</div>
                        </div>
                        <div class="layui-card-body">
                            <ul id="fillingBlankQuestionList">
                                <!--填空题题列表-->
                            </ul>
                        </div>
                    </div>
                    <div class="layui-card">
                        <div class="layui-card-header">
                            <div class="question_title">编程题</div>
                        </div>
                        <div class="layui-card-body">
                            <ul id="codeQuestionList">
                                <!--编程题列表-->
                                <li>
                                    <div class="layui-card">
                                        <div class="layui-card-header panel-title"><span>1、A+B 输入输出练习I</span></div>
                                        <div class="layui-card-body">
                                            <div data-v-6e5e6c6e="" id="problem-content" class="markdown-body">
                                                <p
                                                    data-v-6e5e6c6e="" class="codeTitle">描述</p>
                                                <p data-v-6e5e6c6e="" class="content">
                                                <p>
                                                    你的任务是计算a+b。这是为了acm初学者专门设计的题目。你肯定发现还有其他题目跟这道题的标题类似，这些问题也都是专门为初学者提供的。<br>
                                                </p></p> <p data-v-6e5e6c6e="" class="codeTitle">输入 <!----></p>
                                                <p data-v-6e5e6c6e="" class="content">
                                                <p>输入包含一系列的a和b对，通过空格隔开。一对a和b占一行。<br></p></p> <p data-v-6e5e6c6e=""
                                                                                                class="codeTitle">输出
                                                    <!----></p>
                                                <p data-v-6e5e6c6e="" class="content">
                                                <p>对于输入的每对a和b，你需要依次输出a、b的和。</p>
                                                <p>如对于输入中的第二对a和b，在输出中它们的和应该也在第二行。<br></p></p>
                                                <div data-v-6e5e6c6e="">
                                                    <div data-v-6e5e6c6e="" class="flex-container sample">
                                                        <div data-v-6e5e6c6e="" class="sample-input"><p
                                                                data-v-6e5e6c6e="" class="codeTitle">输入样例 1
                                                            <a data-v-6e5e6c6e="" class="copy"><i data-v-6e5e6c6e=""
                                                                                                  class="ivu-icon ivu-icon-clipboard"></i></a>
                                                        </p>
                                                            <pre data-v-6e5e6c6e="">1 5
10 20</pre>
                                                        </div>
                                                        <div data-v-6e5e6c6e="" class="sample-output"><p
                                                                data-v-6e5e6c6e="" class="codeTitle">输出样例 1</p>
                                                            <pre data-v-6e5e6c6e="">6
30</pre>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <h1>答题卡</h1>
                </div>
                <div class="layui-card-body">
                    <div class="answer-card-content">
                        <div class="answer-card-content-tittle">
                            <div style="width: 150px;float: left;text-align: center;font-weight: bold;padding-top: 10px;">
                                选择题
                            </div>
                            <div style="width: 100px;float: right;text-align: center;padding-top: 10px;">共<span
                                    id="choiceQuestionCount"></span>题
                            </div>
                        </div>
                        <ul id="choiceQuestionIconList">
                        </ul>
                    </div>
                    <div class="answer-card-content">
                        <div class="answer-card-content-tittle">
                            <div style="width: 150px;float: left;text-align: center;font-weight: bold;padding-top: 10px;">
                                判断题
                            </div>
                            <div style="width: 100px;float: right;text-align: center;padding-top: 10px;">共<span
                                    id="judgementQuestionCount"></span>题
                            </div>
                        </div>
                        <ul id="judgementQuestionIconList">

                        </ul>
                    </div>
                    <div class="answer-card-content">
                        <div class="answer-card-content-tittle">
                            <div style="width: 150px;float: left;text-align: center;font-weight: bold;padding-top: 10px;">
                                填空题
                            </div>
                            <div style="width: 100px;float: right;text-align: center;padding-top: 10px;">共<span
                                    id="fillingBlankQuestionCount"></span>题
                            </div>
                        </div>
                        <ul id="fillingBlankQuestionIconList">

                        </ul>
                    </div>
                    <div class="answer-card-content">
                        <div class="answer-card-content-tittle">
                            <div style="width: 150px;float: left;text-align: center;font-weight: bold;padding-top: 10px;">
                                编程题
                            </div>
                            <div style="width: 100px;float: right;text-align: center;padding-top: 10px;">共<span
                                    id="codeQuestionCount"></span>题
                            </div>
                        </div>
                        <ul id="codeQuestionIconList">
                        </ul>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
<script src="/lib/layui-v2.5.6/layui.js" charset="utf-8"></script>
<script src="/lib/jquery-3.4.1/jquery-3.4.1.min.js" charset="utf-8"></script>
<script type="text/javascript">
    function getURLParameter(name) {
        return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || [, ""])[1].replace(/\+/g, '%20')) || null;
    }

    layui.use(['layer', 'form'], function () {
        let layer = layui.layer,
            form = layui.form

        //添加编程题节点
        function addCodeQuestionNode(node, value, k) {

        }

        //添加填空题节点
        function addFillingQuestionNode(node, value, k) {
            node.append('<li><div class="layui-card">' +
                '            <div class="layui-text"><span id=\"fl_title_' + value.questionId + '\">'
                + (k + 1) + '、' + value.question + '</span></div><hr/>' +
                '            <div class="layui-card-body">' +
                '                <form class="layui-form" action="">' +
                '                    <div class="layui-form-item">' +
                '                        <div class="layui-row layui-col-space10" id=\"blank_' + value.questionId + '"></div>' +
                '                    </div>' +
                '                </form>' +
                '            </div>' +
                '        </div></li>');
            for (let i = 1; i <= value.blankCount; i++) {
                $('#blank_' + value.questionId).append('<div class="layui-col-xs6 layui-col-sm6 layui-col-md4"> <label>' + i +
                    '                                        、<input type="text" class="blank" id="blank_' + value.questionId + '_' + i + '">' +
                    '                                    </label></div>')
            }
        }

        //添加判断题目节点
        function addJudgementQuestionNode(node, value, k) {
            node.append('<li><div class="layui-card">' +
                '            <div class="layui-text"><span id=\"ju_title_' + value.id + '\">'
                + (k + 1) + '、' + value.title + '</span></div><hr/>' +
                '            <div class="layui-card-body">' +
                '                <form class="layui-form" action="">' +
                '                    <div class="layui-form-item">' +
                '                        <div class="layui-row layui-col-space10" id=\"judgement_' + value.id + '"></div>' +
                '  <div class="layui-form-item">\n' +
                '    <label class="layui-form-label">选项</label>\n' +
                '    <div class="layui-input-block">\n' +
                '      <input type="radio" name="judgement_a_' + value.id + '" value="true" title="对">\n' +
                '      <input type="radio" name="judgement_a_' + value.id + '" value="false" title="错">\n' +
                '    </div>\n' +
                '  </div>' +
                '                    </div>' +
                '                </form>' +
                '            </div>' +
                '        </div></li>');

        }

        function addChoiceQuestionNode(node, value, k) {
            node.append('<li><div class="layui-card">' +
                '            <div class="layui-text"><span id=\"ch_title_' + value.id + '\">'
                + (k + 1) + '、' + value.title + '</span></div><hr/>' +
                '            <div class="layui-card-body">' +
                '                <form class="layui-form" action="">' +
                '                    <div class="layui-form-item">' +
                '                        <ul id=\"option_' + value.id + '"></ul>' +
                '                    </div>' +
                '                </form>' +
                '            </div>' +
                '        </div></li>');
            if (value.isMultiple) {
                //多选
                if (value.optionA != null && value.optionA !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='checkbox' lay-skin='primary' name='sOption[A]' title='A、" + value.optionA + "'></li>");
                }
                if (value.optionB != null && value.optionB !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='checkbox' lay-skin='primary' name='sOption[B]' title='B、" + value.optionB + "'></li>");
                }
                if (value.optionC != null && value.optionC !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='checkbox' lay-skin='primary' name='sOption[C]' title='C、" + value.optionC + "'></li>");
                }
                if (value.optionD != null && value.optionD !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='checkbox' lay-skin='primary' name='sOption[D]' title='D、" + value.optionD + "'></li>");
                }
                if (value.optionE != null && value.optionE !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='checkbox' lay-skin='primary' name='sOption[E]' title='E、" + value.optionE + "'></li>");
                }
                if (value.optionF != null && value.optionF !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='checkbox' lay-skin='primary' name='sOption[F]' title='F、" + value.optionF + "'></li>");
                }
            } else {
                //单选
                if (value.optionA != null && value.optionA !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='radio' name='sOption' value='A' title='A、" + value.optionA + "'></li>");
                }
                if (value.optionB != null && value.optionB !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='radio' name='sOption' value='B' title='B、" + value.optionB + "'></li>");
                }
                if (value.optionC != null && value.optionC !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='radio' name='sOption' value='B' title='C、" + value.optionC + "'></li>");
                }
                if (value.optionD != null && value.optionD !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='radio' name='sOption' value='B' title='D、" + value.optionD + "'></li>");
                }
                if (value.optionE != null && value.optionE !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='radio' name='sOption' value='E' title='E、" + value.optionE + "'></li>");
                }
                if (value.optionF != null && value.optionF !== "") {
                    $('#option_' + value.id).append("<li class='layui-col-md12'><input type='radio' name='sOption' value='F' title='F、" + value.optionF + "'></li>>");
                }
            }

        }

        //获取考试信息
        $.ajax({
            type: "get",
            async: false,
            url: "/student/getOneExam",
            data: {
                examId: getURLParameter("exam_id")
            },
            success: function (data) {
                if (data.code !== 200) {
                    layer.alert(data.message);
                } else {
                    $('#exam_title').html(data.data.examTitle);
                    document.getElementsByTagName("title")[0].innerText = data.data.examTitle;
                }
            }
        });
        //获取试题信息
        $.ajax({
            type: "get",
            async: false,
            url: "/student/getExamQuestions",
            data: {
                examId: getURLParameter("exam_id")
            },
            success: function (data) {
                if (data.code !== 200) {
                    layer.alert(data.message);
                } else {
                    //获取成功显示题目
                    let choiceQuestionList = data.data.choice_question;
                    $('#choiceQuestionCount').html(choiceQuestionList.length);
                    $.each(choiceQuestionList, function (k, v) {
                        //配置选择题目导航
                        $('#choiceQuestionIconList').append('<li> <a id="ch_card_' +
                            v.id + '" href="#ch_title_'
                            + v.id + '" class="answer-card-yes">' + (k + 1) + '</a></li>');
                        addChoiceQuestionNode($('#choiceQuestionList'), v, k);
                    })

                    //显示判断题
                    let judgementList = data.data.judgement_question;
                    $('#judgementQuestionCount').html(judgementList.length);
                    $.each(judgementList, function (k, v) {
                        $('#judgementQuestionIconList').append('<li> <a id="ju_card_' +
                            v.id + '" href="#ju_title_'
                            + v.id + '" class="answer-card-yes">' + (k + 1) + '</a></li>');
                        addJudgementQuestionNode($('#judgementQuestionList'), v, k)
                    })
                    form.render();
                    //显示填空题
                    let fillingBlankList = data.data.filling_question;
                    $('#fillingBlankQuestionCount').html(fillingBlankList.length);
                    $.each(fillingBlankList, function (k, v) {
                        $('#fillingBlankQuestionIconList').append('<li> <a id="fl_card_' +
                            v.questionId + '" href="#fl_title_'
                            + v.questionId + '" class="answer-card-yes">' + (k + 1) + '</a></li>');
                        addFillingQuestionNode($('#fillingBlankQuestionList'), v, k);
                    })
                    form.render();
                    //显示编程题
                    let codeQuestionList = data.data.code_question;
                    $('#codeQuestionCount').html(codeQuestionList.length);
                    $.each(codeQuestionList, function (k, v) {
                        $('#codeQuestionIconList').append('<li> <a id="cd_card_' +
                            v.id + '" href="#cd_title_'
                            + v.id + '" class="answer-card-yes">' + (k + 1) + '</a></li>');
                        addCodeQuestionNode($('#codeQuestionList'), v, k);
                    })
                }
            }
        });
        $('.addQuestionBtn').each(function () {
            $(this).click(function () {
                if (this.id === "iq1") {
                    //添加选择题
                    layer.open({
                        type: 2,
                        content: '' //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
                    });
                }
            });
        })
    })


</script>
</body>
</html>